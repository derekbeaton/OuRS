## Stolen primarily from SlimPosition (https://github.com/derekbeaton/ExPosition-Family/blob/master/ExPosition2/SlimPosition/Package/R/sp.pca.R)
## Compact will be only: fi, fj, u, v, and d.orig
sp.pca <- function(DATA, center = T, scale = "SS1", k = 0, compact = T, graphs = F){

  res <- gsvd(expo.scale(DATA, center = center, scale = scale), k = k)
  res$type <- "pca"
  
  if(compact){
    res <- list(fi=res$fi, fj=res$fj, d.orig=res$d.orig, u=res$u, v=res$v, type=res$type)
  }
  
  return(res)
}
